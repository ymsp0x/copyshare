import{r as s,j as e,s as v,c as f,L as w}from"./index-iGQR-3dk.js";import{A as M,C as E}from"./AdminSidebar-CnKNgOyC.js";import{B as m}from"./Button-C5OumFf6.js";import{D as z,C as T,A as _,c as I,d as q}from"./index-lZbioHLK.js";import{S as R}from"./search-DB3LOEEu.js";import{E as V}from"./external-link-DOjUPJxS.js";import{c as k}from"./x-gOOsihtg.js";import"./utils-Dsp2dnNP.js";/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=k("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=k("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=k("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);T.register(_,I,q);function Q({stats:i}){const{total:d,active:h,upcoming:c,completed:l}=i,g=s.useMemo(()=>({labels:["Active","Upcoming","Completed"],datasets:[{data:[h,c,l],backgroundColor:["#22c55e","#facc15","#94a3b8"],borderColor:["#16a34a","#eab308","#64748b"],borderWidth:1}]}),[h,c,l]),o=s.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{color:"#9ca3af",font:{size:13}}},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(0, 0, 0, 0.7)",titleColor:"#fff",bodyColor:"#fff",padding:10,cornerRadius:6,displayColors:!0}}}),[]);return e.jsxs("div",{className:"grid grid-cols-1",children:[" ",e.jsxs("div",{className:"bg-white dark:bg-neutral-800 p-7 rounded-xl shadow-lg border border-neutral-100 dark:border-neutral-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-800 dark:text-neutral-50 mb-5",children:"Project Distribution"}),e.jsx("div",{className:"h-64 flex justify-center items-center",children:e.jsx(z,{data:g,options:o})}),e.jsxs("p",{className:"text-base mt-6 text-center text-neutral-500 dark:text-neutral-300",children:[e.jsx("span",{className:"font-semibold text-neutral-700 dark:text-neutral-100",children:"Total Projects:"})," ",e.jsx("strong",{className:"text-2xl text-blue-600 dark:text-blue-400",children:d})]})]})]})}function X(){const[i,d]=s.useState([]),[h,c]=s.useState(!0),[l,g]=s.useState(""),[o,b]=s.useState({total:0,active:0,upcoming:0,completed:0}),[N,p]=s.useState(null),[S,j]=s.useState(!1);s.useEffect(()=>{C()},[]);const C=async()=>{c(!0);try{const{data:t,error:n}=await v.from("projects").select("*").order("created_at",{ascending:!1});if(n)throw n;d(t||[]);const x={total:(t==null?void 0:t.length)||0,active:(t==null?void 0:t.filter(r=>r.status==="Aktif").length)||0,upcoming:(t==null?void 0:t.filter(r=>r.status==="Segera").length)||0,completed:(t==null?void 0:t.filter(r=>r.status==="Selesai").length)||0};b(x)}catch(t){console.error("Error fetching projects:",t),f.error("Failed to load projects")}finally{c(!1)}},A=t=>p(t),P=()=>p(null),D=async t=>{j(!0);const n=i,x=o,r=i.find(a=>a.id===t);if(!r){j(!1),p(null);return}d(a=>a.filter(L=>L.id!==t));const u={...o};switch(u.total-=1,r.status){case"Aktif":u.active-=1;break;case"Segera":u.upcoming-=1;break;case"Selesai":u.completed-=1;break}b(u),f.success("Project deleted successfully (optimistic)");try{const{error:a}=await v.from("projects").delete().eq("id",t);if(a)throw a;f.success("Project deletion confirmed!")}catch(a){console.error("Error deleting project:",a),d(n),b(x),f.error("Failed to delete project, rolling back changes.")}finally{j(!1),p(null)}},y=s.useMemo(()=>i.filter(t=>t.title.toLowerCase().includes(l.toLowerCase())),[i,l]);return e.jsxs("div",{className:"flex min-h-screen bg-neutral-50 dark:bg-neutral-900 font-sans antialiased",children:[e.jsx(M,{}),e.jsx("div",{className:"flex-1 overflow-y-auto lg:ml-64 pt-16 lg:pt-0",children:e.jsxs("main",{className:"p-6 md:p-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[e.jsx("h1",{className:"text-3xl font-extrabold text-neutral-900 dark:text-neutral-50",children:"Dashboard"}),e.jsx(w,{to:"/admin/new",children:e.jsxs(m,{className:"flex items-center px-4 py-2 text-sm",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"New Project"]})})]}),e.jsx("div",{className:"mb-10",children:e.jsx(Q,{stats:o})}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400 dark:text-neutral-500"}),e.jsx("input",{type:"text",placeholder:"Search projects by title...",value:l,onChange:t=>g(t.target.value),className:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-neutral-200 dark:border-neutral-700 bg-white dark:bg-neutral-800 text-neutral-900 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 ease-in-out placeholder-neutral-400"})]}),e.jsx("div",{className:"bg-white dark:bg-neutral-800 rounded-xl shadow-lg overflow-hidden border border-neutral-100 dark:border-neutral-700",children:h?e.jsx("div",{className:"flex justify-center items-center p-16",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500"})}):y.length===0?e.jsxs("div",{className:"text-center p-16",children:[e.jsx("h3",{className:"text-xl font-semibold text-neutral-700 dark:text-neutral-200 mb-3",children:"No projects found"}),e.jsx("p",{className:"text-neutral-500 dark:text-neutral-400 mb-6 max-w-sm mx-auto",children:l?"No results match your search. Try a different query.":"Get started by creating your first project. They will appear here once added."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-neutral-200 dark:divide-neutral-700",children:[e.jsx("thead",{className:"bg-neutral-50 dark:bg-neutral-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Project"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Categories"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Slug"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-neutral-800 divide-y divide-neutral-100 dark:divide-neutral-700",children:y.map(t=>{var n;return e.jsxs("tr",{className:`${N===t.id?"bg-red-50 dark:bg-red-950":"hover:bg-neutral-50 dark:hover:bg-neutral-700"} transition-colors duration-150`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{className:"h-12 w-12 rounded-lg object-cover border border-neutral-100 dark:border-neutral-700",src:t.image_url||"https://images.pexels.com/photos/3182812/pexels-photo-3182812.jpeg",alt:""}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-base font-medium text-neutral-900 dark:text-neutral-100",children:t.title}),t.project_url&&e.jsxs("a",{href:t.project_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 dark:text-blue-400 hover:underline inline-flex items-center mt-1",children:["Visit ",e.jsx(V,{className:"ml-1 h-3.5 w-3.5"})]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${t.status==="Aktif"?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":t.status==="Segera"?"bg-amber-100 text-amber-800 dark:bg-amber-800 dark:text-amber-100":"bg-neutral-100 text-neutral-800 dark:bg-neutral-700 dark:text-neutral-200"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(n=t.categories)==null?void 0:n.slice(0,2).map((x,r)=>e.jsx("span",{className:"bg-blue-50 text-blue-700 dark:bg-blue-900 dark:text-blue-200 px-2.5 py-1 rounded-full text-xs font-medium",children:x},r)),t.categories&&t.categories.length>2&&e.jsxs("span",{className:"bg-neutral-100 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-200 px-2.5 py-1 rounded-full text-xs font-medium",children:["+",t.categories.length-2]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-neutral-500 dark:text-neutral-400 truncate max-w-xs",children:t.slug}),e.jsx("td",{className:"px-6 py-4 text-right text-sm font-medium",children:N===t.id?e.jsxs("div",{className:"flex items-center justify-end space-x-3 text-red-600 dark:text-red-400",children:[e.jsxs("span",{className:"flex items-center text-sm mr-2 font-semibold",children:[e.jsx(F,{className:"h-4 w-4 mr-1.5"}),"Confirm delete?"]}),e.jsx(m,{variant:"danger",size:"sm",onClick:()=>D(t.id),isLoading:S,children:"Yes"}),e.jsx(m,{variant:"outline",size:"sm",onClick:P,children:"No"})]}):e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(w,{to:`/admin/edit/${t.id}`,children:e.jsx(m,{variant:"ghost",size:"sm",children:e.jsx($,{className:"h-4 w-4"})})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>A(t.id),className:"text-red-500 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900",children:e.jsx(B,{className:"h-4 w-4"})})]})})]},t.id)})})]})})})]})})]})}export{X as default};
